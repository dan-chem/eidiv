<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <title>Einsatz {{ obj.nummer_formatiert }}</title>
  <link rel="stylesheet" href="/static/pdfs/print.css">
</head>
<body>
<header id="doc-header">
  <h1>Einsatzbericht</h1>
  <div class="small">
    Nummer: <span class="mono">{{ obj.nummer_formatiert }}</span> |
    Beginn: {{ obj.start_dt|date:"d.m.Y H:i" }} |
    Ende: {{ obj.ende_dt|date:"d.m.Y H:i" }} |
    Dauer: {{ obj.dauer_stunden }} h
  </div>
  <div>Einsatzleiter: {{ obj.einsatzleiter|default:obj.einsatzleiter_text }}</div>
</header>

<section>
  <h2>Einsatzort</h2>
  <div class="grid-2">
    <div><strong>Objektname:</strong> {{ obj.objektname|default:"—" }}</div>
    <div><strong>Adresse:</strong> {{ obj.strasse_hausnr|default:"—" }}, {{ obj.plz_ort|default:"—" }}</div>
    <div><strong>Gemeinde:</strong> {{ obj.einsatzgemeinde|default:"—" }}</div>
    <div><strong>Landkreis:</strong> {{ obj.landkreis|default:"—" }}</div>
  </div>
</section>

<section>
  <h2>Angaben zur Person</h2>
  {% if obj.person %}
    <div class="grid-2">
      <div><strong>Typ:</strong> {{ obj.person.get_typ_display }}</div>
      <div><strong>Name:</strong> {{ obj.person.name_vorname }}</div>
      <div><strong>Straße:</strong> {{ obj.person.strasse_hausnr|default:"—" }}</div>
      <div><strong>PLZ/Ort:</strong> {{ obj.person.plz_ort|default:"—" }}</div>
      <div><strong>Telefon:</strong> {{ obj.person.telefon|default:"—" }}</div>
      <div><strong>KFZ:</strong> {{ obj.person.kfz_kennz|default:"—" }}</div>
      <div class="grid-span-2">
        <strong>Kostenbefreit:</strong> {{ obj.person.kostenbefreit|yesno:"Ja,Nein" }}
        {% if obj.person.kostenbefreit and obj.person.begruendung %} ({{ obj.person.begruendung }}){% endif %}
      </div>
    </div>
  {% else %}
    <div>—</div>
  {% endif %}
</section>

<section>
  <h2>Angaben zum Brand</h2>
  <div class="grid-2">
    <div><strong>Brandumfang:</strong> {{ obj.brandumfang|default:"—" }}</div>
    <div><strong>Brandausbreitung:</strong> {{ obj.brandausbreitung|default:"—" }}</div>
    <div><strong>Brandgut:</strong> {{ obj.brandgut|default:"—" }}</div>
    <div><strong>Brandobjekt:</strong> {{ obj.brandobjekt|default:"—" }}</div>
  </div>
  <h3 class="mt-6">Löschwasserentnahmestellen</h3>
  <table>
    <thead><tr><th>Entnahmestelle</th><th>Menge</th></tr></thead>
    <tbody>
      {% for lw in obj.loeschwasser.all %}
      <tr><td>{{ lw.entnahmestelle }}</td><td>{{ lw.menge|default:"—" }}</td></tr>
      {% empty %}
      <tr><td colspan="2">—</td></tr>
      {% endfor %}
    </tbody>
  </table>
</section>

<section>
  <h2>Angaben zur technischen Hilfeleistung</h2>
  <div class="grid-2">
    <div><strong>Schadensereignis:</strong> {{ obj.schadensereignis|default:"—" }}</div>
    <div><strong>Personenrettung:</strong> {{ obj.personenrettung_typ|default:"—" }}{% if obj.personenrettung_anzahl %} — Anzahl: {{ obj.personenrettung_anzahl }}{% endif %}</div>
    <div><strong>Sicherheitswache:</strong> {{ obj.sicherheitswache|default:"—" }}</div>
    <div><strong>Fehlalarm:</strong> {{ obj.fehlalarm|default:"—" }}</div>
    <div><strong>Sonstige:</strong> {{ obj.sonstige|default:"—" }}</div>
  </div>
</section>

<section>
  <h2>Fahrzeuge / Abrollbehälter / Anhänger / Ortsfeuerwehren</h2>
  <table>
    <thead><tr><th>Typ</th><th>km</th><th>Std.</th><th>erforderlich</th></tr></thead>
    <tbody>
      {% for ef in obj.einsatzfahrzeug_set.all %}
      <tr><td>{{ ef.fahrzeug }}</td><td>{{ ef.kilometer|default:"—" }}</td><td>{{ ef.stunden|default:"—" }}</td><td>{{ ef.erforderlich|yesno:"Ja,Nein" }}</td></tr>
      {% endfor %}
      {% for ea in obj.einsatzanhaenger_set.all %}
      <tr><td>{{ ea.anhaenger }}</td><td>{{ ea.kilometer|default:"—" }}</td><td>{{ ea.stunden|default:"—" }}</td><td>{{ ea.erforderlich|yesno:"Ja,Nein" }}</td></tr>
      {% endfor %}
      {% for ab in obj.einsatzabrollbehaelter_set.all %}
      <tr><td>{{ ab.abrollbehaelter }}</td><td>—</td><td>—</td><td>{{ ab.erforderlich|yesno:"Ja,Nein" }}</td></tr>
      {% endfor %}
      {% for ofw in obj.einsatzortsfeuerwehr_set.all %}
      <tr><td>{{ ofw.ortsfeuerwehr }}</td><td>—</td><td>—</td><td>{{ ofw.erforderlich|yesno:"Ja,Nein" }}</td></tr>
      {% endfor %}
    </tbody>
  </table>
</section>

<section>
  <h2>Zusätzliche anwesende Stellen</h2>
  <ul>
    {% for zs in obj.einsatzzusatzstelle_set.all %}
      <li>{{ zs.zusatzstelle }}</li>
    {% empty %}
      <li>—</li>
    {% endfor %}
  </ul>
</section>

<section>
  <h2>Einsatzmittel</h2>
  <table>
    <thead><tr><th>Artikel</th><th>Anzahl</th></tr></thead>
    <tbody>
      {% for em in obj.einsatzeinsatzmittel_set.all %}
      <tr><td>{{ em.einsatzmittel }}</td><td>{{ em.anzahl }}</td></tr>
      {% empty %}
      <tr><td colspan="2">—</td></tr>
      {% endfor %}
    </tbody>
  </table>
</section>

<section>
  <h2>Einsatzmaßnahmen / Verwendetes Material</h2>
  <div style="white-space: pre-wrap;">{{ obj.einsatzmassnahmen }}</div>
</section>

<!-- Eingesetztes Personal -->
<section>
  <h2>Eingesetztes Personal</h2>

  <!-- Aktive -->
  <h3>Aktive</h3>
  <table class="table table-sm w-100">
    <thead>
      <tr>
        <th style="text-align:left;">Mitglied</th>
        <th style="text-align:left;">Fahrzeug/Funktion</th>
        <th style="text-align:right;">AGT (Min)</th>
      </tr>
    </thead>
    <tbody>
      {% for t in obj.einsatzteilnahme_set.all %}
        {% if not t.mitglied.jugendfeuerwehr %}
          <tr>
            <td>{{ t.mitglied.name }}, {{ t.mitglied.vorname }}{% if t.mitglied.agt %} (AGT){% endif %}</td>
            <td>{{ t.fahrzeug_funktion|default:"—" }}</td>
            <td style="text-align:right;">{{ t.agt_minuten|default:"—" }}</td>
          </tr>
        {% endif %}
      {% endfor %}
    </tbody>
  </table>

  <!-- Jugendfeuerwehr -->
  <h3 style="margin-top:10px;">Jugendfeuerwehr</h3>
  <table class="table table-sm w-100">
    <thead>
      <tr>
        <th style="text-align:left;">Mitglied</th>
        <th style="text-align:left;">Fahrzeug/Funktion</th>
        <th style="text-align:right;">AGT (Min)</th>
      </tr>
    </thead>
    <tbody>
      {% for t in obj.einsatzteilnahme_set.all %}
        {% if t.mitglied.jugendfeuerwehr %}
          <tr>
            <td>{{ t.mitglied.name }}, {{ t.mitglied.vorname }}{% if t.mitglied.agt %} (AGT){% endif %}</td>
            <td>{{ t.fahrzeug_funktion|default:"—" }}</td>
            <td style="text-align:right;">{{ t.agt_minuten|default:"—" }}</td>
          </tr>
        {% endif %}
      {% endfor %}
    </tbody>
  </table>
</section>

<section>
  <h2>Statistik</h2>
  <div class="grid-3">
    <div><strong>Einsatzdauer (h):</strong> {{ obj.dauer_stunden }}</div>
    <div><strong>Gesamtstunden:</strong> {{ obj.gesamtstunden }}</div>
    <div><strong>Eingesetztes Personal:</strong> {{ obj.teilnehmer_anzahl }}</div>
    <div><strong>Hauptamtlich:</strong> {{ obj.teilnehmer_hauptamtlich }}</div>
    <div><strong>Ehrenamtlich:</strong> {{ obj.teilnehmer_ehrenamtlich }}</div>
    <div><strong>km gesamt (Fzg+Anh):</strong> {{ obj.summe_kilometer }}</div>
    <div><strong>Std. Fzg+Anh gesamt:</strong> {{ obj.summe_fahrzeugstunden }}</div>
  </div>
</section>


<footer class="small">
  Unterschrift, Datum
</footer>
</body>
</html>
